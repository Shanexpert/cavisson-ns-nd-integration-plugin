# Name      : nsu_migrate_script
# Author    : 
# Purpsose  : To migrate legacy script to c type script.
#
# Usage     :  nsu_migrate_script -s <Source scriptName> -d <Destination script name>
#
# Modification History:
#   21/06/11: Saloni - Initial Version.
#!/bin/sh
#Check and get login user name
USER_NAME=`whoami 2>/dev/null`

if [ $? != 0 ];then
  echo "Error: Unable to get the real user name"
  exit 1
fi

#Check and get script type and call appropriate class

SCRIPT_NAME_WITH_PATH=$2
WORK_PROFILE=`echo $SCRIPT_NAME_WITH_PATH | cut -d '/' '-f1-2'`
PROJ_SUBPROJ=`dirname $SCRIPT_NAME_WITH_PATH | cut -d '/' '-f3-4'`
SCRIPT_NAME=`basename $SCRIPT_NAME_WITH_PATH`
NS_TA_DIR="$NS_WDIR/workspace/$WORK_PROFILE/cavisson"
#NS_TA_DIR=`nsi_get_work_space_path.sh $WORK_PROFILE $PROJ_SUBPROJ/"scripts"`
if [ "XSCRIPT_NAME_WITH_PATH" == "X" ];then
  echo "error"
fi

if [ ! -d $NS_TA_DIR/$PROJ_SUBPROJ/scripts/$SCRIPT_NAME ]; then
#if [ ! -d $NS_TA_DIR/$SCRIPT_NAME ]; then
  echo "Error in getting script directory $SCRIPT_NAME_WITH_PATH"
  echo "Script may not be present"
  exit -1
fi

SCRIPT_TYPE=`nsu_script_tool -o GetScriptType -s $PROJ_SUBPROJ/"scripts"/$SCRIPT_NAME -w $WORK_PROFILE`
if [ $? != 0 ]; then
echo "Error in getting script type of script $SCRIPT_NAME_WITH_PATH"
  echo "Script may not be present"
fi

if [ "X$SCRIPT_TYPE" == "XLegacy" -o "X$SCRIPT_TYPE" == "XLEGACY" ];then
  if [ -d /home/cavisson/monitors ];then
    java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:/home/cavisson/monitors/lib/java-getopt-1.0.9.jar:$NS_WDIR/webapps/netstorm/lib/swingx-all-1.6.4.jar:$NS_WDIR/webapps/netstorm/lib/runlogic.jar -DNS_WDIR=$NS_WDIR pac1.Bean.MigrateScript $* -u $USER_NAME
  else
    java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:/opt/cavisson/monitors/lib/java-getopt-1.0.9.jar:$NS_WDIR/webapps/netstorm/lib/swingx-all-1.6.4.jar:$NS_WDIR/webapps/netstorm/lib/runlogic.jar -DNS_WDIR=$NS_WDIR pac1.Bean.MigrateScript $* -u $USER_NAME
  fi
  exit $?
fi

if [ "X$SCRIPT_TYPE" == "XC" ];then
echo "Invalid script type $SCRIPT_TYPE"
echo "Operation can not be performed"
exit -1
fi

echo "Invalid script type $SCRIPT_TYPE"
exit -1
