#!/bin/bash
# Name : nsi_java_object_convertor
# Purpose : Pass arguments to the java program
#
#
# Usage: nsi_java_object_convertor -e/-d(encoding or decoding) -D(DEBUG) -l(debug level) -i(input file) -o(output file) -c(console option 
# -e : to enable encoding from XML to binary
# -d : to enable decoding from binary to XML(one of the argument among -e and -d is mandatory)
# -l : to specify DEBUG level
# -i : to specify input file (mandatory argument)
# -o : to specify output file (mandatory argument)
# -c : to specify the console option.
#
#
#
#
#TO Export client jar directory
#files=`ls /home/cavisson/work/koronos_jars`
#jars="`echo $files|sed 's/ /:\/home\/netstorm\/work\/koronos_jars\//g'`"

CLASSPATH=$CLASSPATH:$NS_WDIR/webapps/netstorm/WEB-INF/lib/xstream-1.4.8.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/jettison-1.2.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/xmlpull-1.1.3.1.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/joda-time-1.6.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/dom4j-1.6.1.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/xom-1.1.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/jdom2-2.0.5.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/wstx-asl-3.2.7.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/kxml2-min-2.3.0.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/stax-1.2.0.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/stax-api-1.0.1.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/kxml2-2.3.0.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/xpp3_min-1.1.4c.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/jdom-1.1.3.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/cglib-nodep-2.2.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/ns_object_utility.jar:$NS_WDIR/webapps/netstorm/WEB-INF/lib/java-getopt-1.0.9.jar:

#ADD Client Jar in class path
#CLASSPATH=$CLASSPATH:$NS_WDIR/koronos_jars/"$jars":

encode_flag=""
DEBUG=0;
DEBUG_LEVEL=0
input_file=""
output_file=""
console_option=""
encode_arg=0



usage()
{
  echo "Invalid Usage"
  echo "Usage: nsi_java_object_convertor -e/-d(encoding or decoding) -D(DEBUG) -l(debug level) -i(input file) -o(output file) -c(console option)"
  echo "-e : to enable encoding from XML to binary"
  echo "-d : to enable decoding from binary to XML(one of the argument among -e and -d is mandatory)"  #only one among the -e and -d should be used
  echo "-l : to specify DEBUG level"
  echo "-i : to specify input file (mandatory argument)"
  echo "-o : to specify output file (mandatory argument)"
  echo "-c : to specify the console option."
  exit -1
}

#----------------------------------------------------------


while getopts l:i:o:c:ed? arg
do
  case $arg in
    e) encode_flag=1
       encode_arg=`expr $encode_arg + 1`;;
    d) encode_flag=0
       encode_arg=`expr $encode_arg + 1`;;
    l) DEBUG_LEVEL="$OPTARG";;
    i) input_file="$OPTARG";;
    o) output_file="$OPTARG";;
    c) console_option="$OPTARG";;
    ?) usage;;
  esac
done

if [ $encode_arg -gt 1 ]; then
  echo "Only one of the argument among -e and -d can be passed"
  exit -1
fi

if [ "XX$encode_flag" = "XX"  ]; then
  usage
  exit -1
fi

if [ "XX$input_file" = "XX" -o "XX$output_file" = "XX" ];then
  echo "Both -i and -o arguments are mandatory."
  exit -1
fi

#cd $NS_WDIR/webapps/netstorm/WEB-INF/classes
java -cp $CLASSPATH:$NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar -DNS_WDIR=$NS_WDIR -Djava.awt.headless=true com.cavisson.nsobject.NsObjectTool $*  #TODO
