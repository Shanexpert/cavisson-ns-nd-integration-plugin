# Name      : nsi_merge_sort_scen
# Author    : Atul
# Purpsose  : To merge and sort given scenario file as per $NS_WDIR/etc/KeywordDefinition.dat file
#             used by netstorm.
#
# Usage     :  nsi_merge_sort_scen <MergeAndSort/Sort> <Source scenario name> -d <Destination scenario #              file name>
# Here new page name is optional but if it is given then it must be given for all pages
#
#!/bin/sh
#Check and get login user name
#Option - 0  =>MergeAndSort
#Option - 1  =>Sort

usage()
{
  echo "$0 <option[0/1]> <src scenario file> <dest scenario file> <additional keyword file>"
  exit 1
}

if [ $# -lt 3 -o $# -gt 4 ];then
  usage
fi


OPTION="$1"
SCENARIO_FILE="$2"
SORTED_SCENARIO="$3"
ADDITIONAL_KW="$4"

USER_NAME=`whoami 2>/dev/null`
if [ $? != 0 ];then
  echo "Error: Unable to get the real user name"
  exit 1
fi


rm -f $SORTED_SCENARIO

if [ $OPTION == 0 ];then
   OPTION="MergeAndSort"
elif [ $OPTION == 1 ];then
   OPTION="Sort"
else
   usage
fi 

if [ ! -f $SCENARIO_FILE ];then
  echo $SCENARIO_FILE does not exist.
  exit -1
fi

#cd $NS_WDIR/webapps/netstorm/WEB-INF/classes
#java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar -DNS_WDIR=$NS_WDIR pac1.Bean.MergeSortScen $0  $NS_WDIR/scenarios/$1 $2
#added 2>&1 as stderr should be redirected to stdout
java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:$NS_WDIR/webapps/ROOT/shared/lib/tomcat-security.jar -DNS_WDIR=$NS_WDIR pac1.Bean.MergeSortScen $OPTION $SCENARIO_FILE $SORTED_SCENARIO $USER_NAME $ADDITIONAL_KW 2>&1
if [ $? != 0 ];then
#  echo "Unable to merge $SCENARIO_FILE"
  exit 1
fi 

exit 0
