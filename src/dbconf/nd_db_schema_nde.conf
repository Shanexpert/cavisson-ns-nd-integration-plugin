###############################################################################
# Filename : nd_db_schema.conf
#   
#   *** CAUTION: THIS IS AN ND SYSTEM CONFIGURATION FILE. PLEASE DO NOT CHANGE ***
#
# Author   : Naveen Raina
#
# Synopsis : This file contains information about ND DB tables 
#            This file is read by ND DB Loader.
#
#            Please note that 
#
#            o  Each field is treated as key:value; pair. 
#            o  Each field should be terminated with semicolon (;). This rule
#               must be followed even if the value is blank
#
# Fields   :
#      TableName  : As name suggests, this is the table name. In the actual name, an 
#                   underscore character (_) and the TR number will be appended to this name.
#      Schema     : This is the schema of table exactly in the format to be provided 
#                   to postgres in "CREATE TABLE". Hence if any comments are to be 
#                   be provided, it should start with two hyphens (i.e. --).
#      PrimaryKey : Primary Key
#      Index(es)  : List of all the Indexes to be put on the table. 
#                   Format  : <Field1>[,<Field2>],...[|<Field1>[,<Field2>]...]
#                   Example : FlowpathInstance | FlowpathInstance, FlowpathBeginTimestamp
#                   This will create two Index(es)es on the table (say flowpath table) for 
#                   which these Index(es)es are defined.
###############################################################################

#-----------------------------------------------------
TableName  : flowpath;
Schema     : FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex smallint,
             AppIndex smallint,
             FlowPathSegmentTier int,
             BeginSeqNum text,
             BTCategory smallint,
             FlowPathSignature int,
             ResponseTime  bigint,
             FlowpathInitialParameter int,
             FlowPathSequenceBlob text,
             FlowPathBeginTimestamp bigint,
             FlowPathEndTimestamp bigint,
             CumCpuTime bigint,
             URLQueryParmStr text,
             MethodsCount int,
             StatusCode smallint,
             PrevFlowPathInstance bigint,
             CallOutCount int,
             URLIndex int;
PrimaryKey :; 
Index(es)  : FlowPathInstance > FPI |
             FlowPathInstance, FlowPathBeginTimestamp > FPI_FPBGNTS |
             FlowPathInstance, FlowPathEndTimestamp > FPI_FPENDTS |
             StatusCode > STC |
             BTCategory > BTCAG |
             URLIndex > URLID;
#-----------------------------------------------------
TableName  : ndsqlrecord;
Schema     : FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex smallint,
             AppIndex smallint,
             SQLBeginTimestamp bigint,
             SQLExecTime bigint,
             SQLIndex int,
             SQLQueryParmStr text;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI |
             SQLBeginTimestamp > SQLBGNTS |
             FlowPathInstance, SQLIndex > FPI_SQLIDX |
             FlowPathInstance, SQLBeginTimestamp > FPI_SQLBGNTS;

#-----------------------------------------------------
TableName  : urlrecord;
Schema     : TestIndex int,
             UrlIndex int,
             SessionIndex int,
             SessionInstance int,    
             TransactionIndex int,
             PageIndex int,
             ChildIndex int,
             TxInstance smallint,
             PageInstance smallint,
             FetchedFrom smallint,
             HTTSReqReused bool,
             ConReused bool,
             UrlType smallint,
             StartTime bigint,
             DnsDuration int,
             ConnectDuration int,
             SSLHandshakeDuration int,
             WriteCompleteDuration int,
             FirstByteRcdDuration int,
             RequestCompleteDuration int,
             RenderingDuration int,
             EndTime bigint,
             HttpResponseCode smallint,
             HttpPayloadBytesSent int,
             AppBytesSent int,
             EthBytesSent int,
             HttpPayloadBytesRcd int,
             AppBytesRcd int,
             EthBytesRcd int,
             CompletionMode smallint,
             Status smallint,
             ConnectionNumber int,
             ConnectionType smallint,
             Retries smallint,
             FlowPathInstance bigint,
             RespTime int,
             PhaseIndex int,
             GeneratorId int;
PrimaryKey :;
Index(es)  : StartTime > STTM |
             EndTime > ENDTM |
             URLIndex, StartTime > URLID_STTM | 
             URLIndex, EndTime > URLID_ENDTM |
             UrlIndex > URLID |
             FlowPathInstance > FPI |
             Status > ST;

#-----------------------------------------------------
TableName  : ndautosensorhotspotthreads;
Schema     : TierID int,
             ServerID int,
             appID int,
             ThreadId bigint,
             ThreadName text,
             HotSpotStartTimeStamp bigint,
             HotSpotDuration int,
             NewOrContinue smallint,
             ThreadState text,
             ThreadPriority int,
             ThreadStackDepth int,
             ThreadCPUTime int,
             ThreadUserTime int,
             FlowPathInstance bigint,
             LastUpdateTimeStamp bigint,
             DummyField1 smallint,
             DummyField2 smallint,
             DummyField3 smallint,
             DummyField4 smallint,
             DummyField5 smallint,
             ThreadStackTrace text;
PrimaryKey :;
Index(es)  : TierID > TRID |
             ServerID > SERID |
             AppID > APPID |
             ThreadId > THDID |
             HotSpotStartTimeStamp > HSTS;

#-----------------------------------------------------
TableName  : ndbciarg;
Schema     : FlowPathInstance bigint,
             SeqNum text,
             BCIArgId int,
             MethodId int,
             TierID int,
             ServerID int,
             AppID int,
             SelfTime bigint,
             CpuTime bigint;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI |
             BCIArgID > BARG |
             MethodID > MID |
             TierID > TRID |
             ServerID > SERID |
             AppID > APPID;

#-----------------------------------------------------
TableName  : ndmethodtiming;
Schema     : MethodId bigint,
             TierIndex smallint,
             ServerIndex smallint,
             AppIndex smallint,
             CumSelfTime bigint,
             CumCPUTime bigint,
             Count int,
             Min bigint,
             Max bigint,
             StartTime bigint,
             EndTime bigint,
             CumWallTime bigint;
PrimaryKey :;
Index(es)  : TierIndex > TRID |
             ServerIndex > SERID |
             AppIndex > APPID |
             MethodId, StartTime > MTDID_STRTTM |
             MethodId, EndTime > MTDID_ENDTM;

#-----------------------------------------------------
TableName  : ndapplogs;
Schema     : Date bigint,
             FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex smallint,
             AppIndex smallint,
             TimeStamp bigint,
             Thread text,
             Severity text,
             Classname text,
             Methodname text,
             Filename text,
             Linenumber INT,
             Message text;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI |
             Severity > SEV |
             Date > DT |
             FlowPathInstance, Severity > FPI_SEV;

#-----------------------------------------------------
TableName  : ndjms;
Schema     : FlowPathInstance bigint,
             TimeStamp bigint,
             FieldType smallint,
             Sequence int,
             Key text,
             Value text;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI;

#-----------------------------------------------------
TableName  : metadata;
Schema     : Entityid int,
             MetaType smallint,
             EntityName text;
PrimaryKey : Entityid,MetaType;
Index(es)  :;

#-----------------------------------------------------
TableName  : urltable;
Schema     : TestIndex int,
             UrlIndex int,
             PageIndex int,
             HashID int,
             HashCode bigint,
             Len int,
             UrlName VARCHAR(4096),
             PageURLNameLen int,
             PageURLName VARCHAR(8192);
PrimaryKey :;
Index(es)  : UrlIndex > URLID;

#-----------------------------------------------------
TableName  : ndsql;
Schema     : FlowPathInstance bigint,
             SQLIndex int,
             QueryType smallint,
             SQLQuery text;
PrimaryKey : FlowPathInstance,SQLIndex;
Index(es)  : FlowPathInstance > FPI |
             SQLIndex > SQLIDX |
             QueryType > QTYPE |
             SQLQuery > SQLQ;

#-----------------------------------------------------
TableName  : ndfunctionalgroup;
Schema     : fn_grp text,
             path text;
PrimaryKey : path;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndappinstance;
Schema     : appName text,
             appID int,
             ServerID int,
             TierID int,
             BCIPort int;
PrimaryKey :;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndappserver;
Schema     : ServerName text,
             ServerID int,
             TierID int,
             NDAgentPort int;
PrimaryKey :;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndtier;
Schema     : TierName text,
             TierID int;
PrimaryKey :;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionclass;
Schema     : ExceptionClassID int,
             ExceptionClassName text;
PrimaryKey : ExceptionClassID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionthrowingclass;
Schema     : ExceptionThrowingClassID int,
             ExceptionThrowingClassName text;
PrimaryKey : ExceptionThrowingClassID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionthrowingmethod;
Schema     : ExceptionThrowingMethodID int,
             ExceptionThrowingMethodName text;
PrimaryKey : ExceptionThrowingMethodID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionmessage;
Schema     : ExceptionMessageID int,
             ExceptionMessage text;
PrimaryKey : ExceptionMessageID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionstacktrace;
Schema     : ExceptionStackTraceID int,
             ExceptionStackTrace text;
PrimaryKey : ExceptionStackTraceID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptioncause;
Schema     : ExceptionCauseID int,
             ExceptionCause text;
PrimaryKey : ExceptionCauseID;
Index(es)  :;

#-----------------------------------------------------
TableName   : ndexceptions;
Schema     : FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex smallint,
             AppIndex smallint,
             TimeStamp bigint,
             ExceptionClassID int,
             ThrowingClassID int,
             ThrowingMethodID int,
             LineNumber int,             
             MessageID int,
             CauseID int,
             StackTraceID int;
PrimaryKey :;
Index(es)  : ExceptionClassID > EXCCLSID |
             ThrowingClassID > THRCLSID |
             ThrowingMethodID > THRMID |
             CauseID > CAUID |
             StackTraceID > STKTRCID |
             MessageID >MSGID;

#-----------------------------------------------------
TableName  : ndhttpheadermetadata;
Schema     : HeaderNameOrValue text,
             HeaderID int;
PrimaryKey :;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndhttpcaptureheader;
Schema     : FlowPathInstance bigInt,
             HTTPHeadername text,
             HTTPHeadervalue text,
             HTTPHeaderSequence smallInt,
             HTTPObjType smallint,
             TierId smallInt,
             ServerId smallInt,
             appId smallInt;
PrimaryKey :;
Index(es)  : FlowpathInstance > FPI;

#-----------------------------------------------------
