###############################################################################
# Filename : nd_db_schema.conf
#   
#   *** CAUTION: THIS IS AN ND SYSTEM CONFIGURATION FILE. PLEASE DO NOT CHANGE ***
#
# Author   : Naveen Raina
#
# Synopsis : This file contains information about ND DB tables 
#            This file is read by ND DB Loader.
#
#            Please note that 
#
#            o  Each field is treated as key:value; pair. 
#            o  Each field should be terminated with semicolon (;). This rule
#               must be followed even if the value is blank
#
# Fields   :
#      TableName  : As name suggests, this is the table name. In the actual name, an 
#                   underscore character (_) and the TR number will be appended to this name.
#      Schema     : This is the schema of table exactly in the format to be provided 
#                   to postgres in "CREATE TABLE". Hence if any comments are to be 
#                   be provided, it should start with two hyphens (i.e. --).
#      PrimaryKey : Primary Key
#      Index(es)  : List of all the Indexes to be put on the table. 
#                   Format  : <Field1>[,<Field2>],...[|<Field1>[,<Field2>]...]
#                   Example : FlowpathInstance | FlowpathInstance, FlowpathBeginTimestamp
#                   This will create two Index(es)es on the table (say flowpath table) for 
#                   which these Index(es)es are defined.
###############################################################################

#-----------------------------------------------------
TableName  : flowpath;
Schema     : FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             FlowPathSegmentTier int,
             BeginSeqNum text,
             BTCategory smallint,
             FlowPathSignature int,
             ResponseTime  bigint,
             FlowpathInitialParameter int,
             FlowPathSequenceBlob text,
             FlowPathBeginTimestamp bigint,
             FlowPathEndTimestamp bigint,
             CumCpuTime bigint,
             URLQueryParmStr text,
             MethodsCount int,
             StatusCode smallint,
             PrevFlowPathInstance bigint,
             CallOutCount int,
             URLIndex int,
             CorrelationId varchar(256),
             BTCpuTime bigint,
             TotalError int,
             HTTPMethod smallint,
             EntryPointId int,
             DBCallCounts  int,
             HTTPCalloutCount  int,
             JMSCallCount  int,
             ExceptionCount  int,
             CoherenceCount  int,
             NDSessionId bigint,
             NVSessionId bigint,
             NVPageId smallint ,
             Thread varchar(256),
             FlowpathType smallint,
             WaitTime bigint,
             SyncTime bigint,
             IOTime bigint,
             SuspensionTime bigint,
             QTimeInMS bigint,
             SelfResponseTime bigint,
             ParentFlowPathInstance bigint,
             BackendId int[],
             BackendMaxRespTime int[],
             Garagecollectionover int,
             DynamicLoggingFlag int,
             TraceRequest int;

PrimaryKey :; 
Index(es)  : FlowPathInstance > FPI |
             FlowPathInstance, FlowPathEndTimestamp > FPI_FPENDTS |
             FlowPathSignature > FPSIG > !NDE |
             StatusCode > STC |
             BTCategory > BTCAG |
             URLIndex > URLID |
             CorrelationId > CORRID|
             NDSessionId > NDSESSID|
             TierIndex > TINDEX|
             PrevFlowPathInstance > PFPI|
             FlowPathEndTimestamp > FPI_ENDTS|
             FlowpathType > FTYPE|
             ResponseTime > RSTIME;
#----------------------------------------------------
TableName  : NDCallout;
Schema     : FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             URLIndex int,
             Type char,
             SeqNum varchar,
             CalloutRequestSeqNo int,
             BackendId int,
             BackendType int,
             BackendSubType int,
             StartTime bigint,
             Duration double precision,
             StatusCode int,
             ResourceId bigint,
             SenderNetDelay int,
             RecieverNetDelay int,
             PrevFlowpathInstance bigint,
             FirstFlowpathInstance bigint,
             MinDur int,
             MaxDur int,
             TotalDur int, 
             Count int,
             ErrorCount int,
             FutureUse1 int,
             FutureUse2 int,
             FutureUse3 varchar,
             FutureUse4 varchar;
             
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI |
             PrevFlowpathInstance > PREVFPI |
             FirstFlowpathInstance > FFPI |
             StartTime >ST;
           
             
#----------------------------------------------------
TableName  : ndipresourcetiming;
Schema     : ResourceIndex bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             URLIndex int,
             FlowpathInstance bigint,
             CumResourceExecTime numeric,
             Count int,
             Min numeric,
             Max numeric,
             StartResourceBeginTimeStamp bigint,
             EndResourceBeginTimeStamp bigint,
             FailedResourceCount int;
PrimaryKey :;
Index(es)  : TierIndex > TRID |
             ServerIndex > SERID |
             AppIndex > APPID |
             FlowPathInstance > FPI |
             ResourceIndex > RIDX |
             EndResourceBeginTimeStamp > ERBTM|
             FlowPathInstance, EndResourceBeginTimeStamp > FPI_ERBTM;

#-----------------------------------------------------

TableName  : ndipresourcemetadata;
Schema     : ResourceIndex int,
             ResourceName text;
PrimaryKey :;
Index(es)  : ResourceIndex > RSIDX ;

#-----------------------------------------------------
TableName  : ndsqlrecord;
Schema     : FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             SQLBeginTimestamp bigint,
             SQLExecTime bigint,
             SQLIndex int,
             SQLQueryParmStr text,
             UrlIndex int;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI |
             SQLIndex > SQLIDX > !NDE |
             SQLBeginTimestamp > SQLBGNTS |
             SQLExecTime > SQLET > !NDE |
             FlowPathInstance, SQLIndex > FPI_SQLIDX |
             FlowPathInstance, SQLBeginTimestamp > FPI_SQLBGNTS|
             UrlIndex > URLIDX;

#-----------------------------------------------------

TableName  : urlrecord;
Schema     : TestIndex int,
             UrlIndex int,
             SessionIndex int,
             SessionInstance int,    
             TransactionIndex int,
             PageIndex int,
             ChildIndex int,
             TxInstance smallint,
             PageInstance smallint,
             FetchedFrom smallint,
             HTTSReqReused bool,
             ConReused bool,
             UrlType smallint,
             StartTime bigint,
             DnsDuration int,
             ConnectDuration int,
             SSLHandshakeDuration int,
             WriteCompleteDuration int,
             FirstByteRcdDuration int,
             RequestCompleteDuration int,
             RenderingDuration int,
             EndTime bigint,
             HttpResponseCode smallint,
             HttpPayloadBytesSent int,
             AppBytesSent int,
             EthBytesSent int,
             HttpPayloadBytesRcd int,
             AppBytesRcd int,
             EthBytesRcd int,
             CompletionMode smallint,
             Status smallint,
             ConnectionNumber int,
             ConnectionType smallint,
             Retries smallint,
             FlowPathInstance bigint,
             RespTime int,
             PhaseIndex int,
             GeneratorId int;
PrimaryKey :;
Index(es)  : StartTime > STTM |
             EndTime > ENDTM |
             URLIndex, EndTime > URLID_ENDTM |
             UrlIndex > URLID |
             PageIndex > PGIDX > !NDE |
             SessionIndex > SESSID > !NDE |
             TransactionIndex > TXIDX > !NDE |
             FlowPathInstance > FPI |
             Status > ST |
             UrlIndex, ChildIndex, SessionInstance, PageInstance > URLID_NVMID_SESSINST_PGINST > !NDE |
             RespTime > REPTM > !NDE |
             GeneratorID > GENID > !NDE |
             PhaseIndex > PHID > !NDE;

#-----------------------------------------------------
TableName  : ndautosensorhotspotthreads;
Schema     : TierID int,
             ServerID int,
             appID int,
             ThreadId bigint,
             ThreadName text,
             HotSpotStartTimeStamp bigint,
             HotSpotDuration int,
             NewOrContinue smallint,
             ThreadState text,
             ThreadPriority int,
             ThreadStackDepth int,
             ThreadCPUTime int,
             ThreadUserTime int,
             FlowPathInstance bigint,
             LastUpdateTimeStamp bigint,
             DummyField1 smallint,
             DummyField2 smallint,
             DummyField3 smallint,
             DummyField4 smallint,
             DummyField5 smallint,
             ThreadStackTrace text;
PrimaryKey :;
Index(es)  : TierID > TRID |
             ServerID > SERID |
             AppID > APPID |
             ThreadId > THDID |
             HotSpotStartTimeStamp > HSTS;

#-----------------------------------------------------
TableName  : ndbciarg;
Schema     : FlowPathInstance bigint,
             SeqNum text,
             BCIArgId int,
             MethodId int,
             TierID int,
             ServerID int,
             AppID int,
             SelfTime bigint,
             CpuTime bigint,
             TimeStamp bigint,
             WallTime bigint,
             SyncTime bigint,
             IOTime bigint,
             SuspensionTime bigint;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI |
             BCIArgID > BARG |
             MethodID > MID |
             TierID > TRID |
             ServerID > SERID |
             AppID > APPID|
             FlowPathInstance, TimeStamp > FPI_TMSP;

#-----------------------------------------------------
TableName  : ndmethodtiming;
Schema     : MethodId bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             CumSelfTime bigint,
             CumCPUTime bigint,
             Count int,
             Min bigint,
             Max bigint,
             StartTime bigint,
             EndTime bigint,
             CumWallTime bigint,
             CumSelfCPUTime bigint,
             FlowpathInstance bigint,
             URLIndex int,
             CumWaitTime bigint,
             CumSyncTime bigint,
             CumIOTime bigint,
             CumSuspensionTime bigint,
             CumSelfWaitTime bigint,
             CumSelfSyncTime bigint,
             CumSelfIOTime bigint,
             CumSelfSuspensionTime bigint;
PrimaryKey :;
Index(es)  : TierIndex > TRID |
             ServerIndex > SERID |
             AppIndex > APPID |
             MethodId, EndTime > MTDID_ENDTM |
             URLIndex > URLID|
             FlowPathInstance > FPI|
             MethodId > MTDID;

#-----------------------------------------------------
TableName  : ndsqltiming;
Schema     : SQLIndex bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             URLIndex int,
             FlowpathInstance bigint,
             CumSQLExecTime numeric,
             Count int,
             Min numeric,
             Max numeric,
             StartSQLBeginTimeStamp bigint,
             EndSQLBeginTimeStamp bigint,
             FailedQueryCount int,
             BackendId int;
PrimaryKey :;
Index(es)  : TierIndex > TRID |
             ServerIndex > SERID |
             AppIndex > APPID |
             FlowPathInstance > FPI |
             SQLIndex > SQLIDX |
             StartSQLBeginTimeStamp > SSQLBTM |
             EndSQLBeginTimeStamp > ESQLBTM|
             FlowPathInstance, EndSQLBeginTimeStamp > FPI_ESQLBTM|
             BackendId > BCKDIDX;

#-----------------------------------------------------
TableName  : ndapplogs;
Schema     : Date bigint,
             FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             TimeStamp bigint,
             Thread text,
             Severity text,
             Classname text,
             Methodname text,
             Filename text,
             Linenumber INT,
             Message text;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI |
             Severity > SEV |
             Date > DT |
             FlowPathInstance, Severity > FPI_SEV;

#-----------------------------------------------------
TableName  : ndjms;
Schema     : FlowPathInstance bigint,
             TimeStamp bigint,
             FieldType smallint,
             Sequence int,
             Key text,
             Value text;
PrimaryKey :;
Index(es)  : FlowPathInstance > FPI;

#-----------------------------------------------------
TableName  : metadata;
Schema     : Entityid int,
             MetaType smallint,
             EntityName text;
PrimaryKey : Entityid,MetaType;
Index(es)  : Entityid > ENTITYID |
             MetaType > METATYPE;

#-----------------------------------------------------
TableName  : urltable;
Schema     : TestIndex int,
             UrlIndex int,
             PageIndex int,
             HashID int,
             HashCode bigint,
             Len int,
             UrlName VARCHAR(4096),
             PageURLNameLen int,
             PageURLName VARCHAR(8192);
PrimaryKey :;
Index(es)  : UrlIndex > URLID;

#-----------------------------------------------------
TableName  : ndsql;
Schema     : FlowPathInstance bigint,
             SQLIndex int,
             QueryType smallint,
             SQLQuery text;
PrimaryKey : FlowPathInstance,SQLIndex;
Index(es)  : FlowPathInstance > FPI |
             SQLIndex > SQLIDX |
             QueryType > QTYPE; 

#-----------------------------------------------------
TableName  : ndfunctionalgroup;
Schema     : fn_grp text,
             path text;
PrimaryKey : path;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndappinstance;
Schema     : appName text,
             appID int,
             ServerID int,
             TierID int,
             BCIPort int,
             instance_type text,
             discoveryTime bigint,
             lastDisconnectedTime bigint,
             attributes jsonb;
PrimaryKey : appName,appID,ServerID,TierID;
Index(es)  : appName > APPNAME |
             appID > APPID;

#-----------------------------------------------------
TableName  : ndappserver;
Schema     : ServerName text,
             ServerID int,
             TierID int,
             NDAgentPort int,
             discoveryTime bigint,
             lastDisconnectedTime bigint;
PrimaryKey : ServerName,ServerID,TierID;
Index(es)  : ServerName > SERVERNAME |
             ServerID > SERVERID;

#-----------------------------------------------------
TableName  : ndtier;
Schema     : TierName text UNIQUE,
             TierID int;
PrimaryKey : TierID;
Index(es)  : TierName > TIERNAME |
             TierID > TIERID;

#-----------------------------------------------------
TableName  : ndexceptionclass;
Schema     : ExceptionClassID int,
             ExceptionClassName text;
PrimaryKey : ExceptionClassID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionthrowingclass;
Schema     : ExceptionThrowingClassID int,
             ExceptionThrowingClassName text;
PrimaryKey : ExceptionThrowingClassID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionthrowingmethod;
Schema     : ExceptionThrowingMethodID int,
             ExceptionThrowingMethodName text;
PrimaryKey : ExceptionThrowingMethodID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionmessage;
Schema     : ExceptionMessageID int,
             ExceptionMessage text;
PrimaryKey : ExceptionMessageID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptionstacktrace;
Schema     : ExceptionStackTraceID int,
             ExceptionStackTrace text;
PrimaryKey : ExceptionStackTraceID;
Index(es)  :;

#-----------------------------------------------------
TableName  : ndexceptioncause;
Schema     : ExceptionCauseID int,
             ExceptionCause text;
PrimaryKey : ExceptionCauseID;
Index(es)  :;

#-----------------------------------------------------
TableName   : ndexceptions;
Schema     : FlowPathInstance bigint,
             TierIndex smallint,
             ServerIndex int,
             AppIndex int,
             TimeStamp bigint,
             ExceptionClassID int,
             ThrowingClassID int,
             ThrowingMethodID int,
             LineNumber int,             
             MessageID int,
             CauseID int,
             StackTraceID int,
             Backend_id int,
             SeqNum int,
             Backend_Type int,
             Backend_Subtype int;
PrimaryKey :;
Index(es)  : ExceptionClassID > EXCCLSID |
             ThrowingClassID > THRCLSID |
             ThrowingMethodID > THRMID |
             CauseID > CAUID |
             StackTraceID > STKTRCID |
             MessageID > MSGID|
             Backend_id > BEID|
             SeqNum > SNUM|
             Backend_Subtype > B_STYPE|
             FlowPathInstance, TimeStamp > FPI_TSTART|
             TimeStamp > TSTART;
#-----------------------------------------------------
TableName  : ndhttpheadermetadata;
Schema     : HeaderNameOrValue text,
             HeaderID int;
PrimaryKey :;
Index(es)  :HeaderID > HDERID;

#-----------------------------------------------------
TableName  : ndcustomdata;
Schema     : timestamp bigint,
             FlowPathInstance bigInt,
             NameId int,
             HTTPHeadername text,
             ValueType smallint,
             ValueInt bigint,
             HTTPHeadervalue text,
             TierId smallInt,
             ServerId Int,
             appId int;
PrimaryKey :;
Index(es)  : FlowpathInstance > FPI|
             FlowPathInstance, TimeStamp > FPI_TIME|
             NameId > NAME|
             ValueInt > VALUE|
             ValueType > VALUETYPE;

#-----------------------------------------------------
