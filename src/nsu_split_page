# Name      : nsu_split_page
# Author    : Prabhat
# Purpsose  : To split the page in script (script.c, script.h, script.capture, script.detail) files.
#
# Usage     :  nsu_split_page -s <scriptName> -o <Orignal_Page_name> -p <New_Page_name> -i <Index_of_splited_emb_URL> <Debug on(-D)>
#   e.g.  nsu_split_page -s tours -o login -p NEW_ONE -i 3 -D -u Workspace_name -p Profile_name
#
# Modification History:
#   12/28/08: Prabhat - Initial Version
#   06/22/11: Saloni - Integration with toolfor C Type script
#
#!/bin/sh

#Check and get login user name
USER_NAME=`whoami 2>/dev/null`
if [ $? != 0 ];then
  echo "Error: Unable to get the real user name"
  exit 1
fi

#Check and get script type and call appropriate class

SCRIPT_NAME_WITH_PATH=$2
WORK_PROFILE=$4
NS_RTA_DIR="workspace/$WORK_PROFILE/cavisson"

if [ ! -d $NS_WDIR/$NS_RTA_DIR/$SCRIPT_NAME_WITH_PATH]; then
  echo "Error in getting script directory $SCRIPT_NAME_WITH_PATH"
  echo "Script may not be present"
  exit -1
fi

SCRIPT_TYPE=`nsu_script_tool -o GetScriptType -s $SCRIPT_NAME_WITH_PATH -w $WORK_PROFILE`
if [ $? != 0 ]; then
echo "Error in getting script type of script $SCRIPT_NAME_WITH_PATH"
  echo "Script may not be present"
fi

if [ "X$SCRIPT_TYPE" == "XLegacy" -o "X$SCRIPT_TYPE" == "XLEGACY" ];then
  
  #cd $NS_WDIR/webapps/netstorm/WEB-INF/classes
  if [ -d /home/cavisson/monitors ];then
    java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:/home/cavisson/monitors/lib/java-getopt-1.0.9.jar:$NS_WDIR/webapps/netstorm/lib/jmimemagic-0.1.0.jar:$NS_WDIR/webapps/netstorm/lib/apache-jakarta-oro.jar:$NS_WDIR/webapps/netstorm/lib/commons-logging-1.1.1.jar -DNS_WDIR=$NS_WDIR pac1.Bean.SplitPage $* -u $USER_NAME
  else
    java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:/opt/cavisson/monitors/lib/java-getopt-1.0.9.jar:$NS_WDIR/webapps/netstorm/lib/jmimemagic-0.1.0.jar:$NS_WDIR/webapps/netstorm/lib/apache-jakarta-oro.jar:$NS_WDIR/webapps/netstorm/lib/commons-logging-1.1.1.jar -DNS_WDIR=$NS_WDIR pac1.Bean.SplitPage $* -u $USER_NAME
  fi
  exit $?

fi

if [ "X$SCRIPT_TYPE" == "XC" ] || [ "X$SCRIPT_TYPE" == "XJAVA" ];then
  if [ -d /home/cavisson/monitors ];then
    java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:/home/cavisson/monitors/lib/java-getopt-1.0.9.jar:$NS_WDIR/webapps/netstorm/lib/jmimemagic-0.1.0.jar:$NS_WDIR/webapps/netstorm/lib/apache-jakarta-oro.jar:$NS_WDIR/webapps/netstorm/lib/commons-logging-1.1.1.jar -DNS_WDIR=$NS_WDIR pac1.Bean.SplitPageForCType $* -u $USER_NAME
  else
    java -cp $NS_WDIR/webapps/netstorm/WEB-INF/lib/netstorm_bean.jar:/opt/cavisson/monitors/lib/java-getopt-1.0.9.jar:$NS_WDIR/webapps/netstorm/lib/jmimemagic-0.1.0.jar:$NS_WDIR/webapps/netstorm/lib/apache-jakarta-oro.jar:$NS_WDIR/webapps/netstorm/lib/commons-logging-1.1.1.jar -DNS_WDIR=$NS_WDIR pac1.Bean.SplitPageForCType $* -u $USER_NAME
  fi
  exit $?

fi

 echo "Invalid script type $SCRIPT_TYPE"
 exit -1
